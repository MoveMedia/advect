<template id="todo-item" todoName="string" todoComplete="boolean" onFinish="callback" adv>
  <style>
    todo-item {
      li{
        max-width: 300px;
        padding: 0;
          height: 0;
          opacity: 0;
          transition: all 0.3s ease;
          &.ready{
            height: auto;
            opacity: 1;
             padding: 20px 10px;

          }
      }
      &[todoComplete="true"] {
        & li{
          background-color: color-mix(in srgb, green, transparent);
        }

        & .title {
          text-decoration: line-through;
        }
      }
    }
  </style>
  <script>
    const { todoComplete, onFinish, todoName } = $self.attr;
    const { completeBtn, deleteBtn, item } = $self.refs;

    const completedText = "âœ… Finished";
    const incompletedText = "ðŸ”¥ Finish";
    
    completeBtn.innerText = todoComplete.value ? completedText : incompletedText;

    const finishTodo = () => {
      todoComplete.value = true;
      completeBtn.innerText = completedText;
      onFinish?.value(todoName.value);
    };
    const unfinishTodo = () => {
      todoComplete.value = false;
      completeBtn.innerText = incompletedText;
    };
    const deleteTodo = () => {
      const handle =() => {
        item.removeEventListener('transitionend', handle);
        $self.remove();
      }
      item.addEventListener('transitionend', handle);
      item.classList.remove('ready');
    };

    return {
      todoName,
      todoComplete,
      finishTodo,
      unfinishTodo,
      deleteTodo,

    };
  </script>

  <li id="item" onload="{
        $ref.classList.add('ready');
  }">
    <input id="title" class="title"
      onload="{
        $ref.value = $scope.todoName.value ?? '';
      }"
    />
    <button id="completeBtn"
        onclick="{
        if ($scope.todoComplete.value === true) {
            $scope.unfinishTodo()
        }else{
            $scope.finishTodo()
        }
        }"></button>
    <button id="deleteBtn" onclick="$scope.deleteTodo()">Delete</button>
  </li>
</template>