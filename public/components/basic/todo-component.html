<script type="text/adv" src="components/basic/todo-item.html"></script>
<template id="todo-component" adv>
  <div id="wrapper" class="todo-wrapper">
    <form part="submit_form" id="form" onload="console.log('scope is',scope)" onsubmit="scope.onSubmit(event)">
      <slot name="title">
        <h2 class="font-bold">Todos</h2>
      </slot>
      <div>
        <label for="input">
          <span>Add a todo</span>
          <input id="input_name" type="text" name="todo name input" class="border-b-2 border-slate-500" required />
        </label>
        <button class="">Submits</button>
      </div>
    </form>
    <ul id="list">
      <adv-view id="view">
        <style>
          :host{
            background: green;
          }
        </style>
        [[#todos]]
          <todo-item data-title="[[title]]" id="[[id]]" data-id="[[id]]" data-complete="false"></todo-item>
        [[/todos]]
        [[^todos]]
         <li>No todos yet</li>
        [[/todos]]
      </adv-view>
    </ul>
  </div>
    <!--  -->
  <script>
      let todos = []; 
      const { input_name, view } = self.refs; // this is more efficient because refs reuns a querySelector

      const onSubmit = (event) => {
        event.preventDefault();
        const todo = {
          id: Date.now(),
          title: input_name.value,
          complete: false
        };
        todos.push(todo);
        input_name.value = '';
        view.render({ todos });
      }
      $self.on('delete:todo', (event) => {
        todos = todos.filter(todo => todo.id != event.detail.todo.dataset.id );
        event.detail.todo.remove();
        self.refs.view.render({ todos });
      });


      const scope =
       {
        todos,
        onSubmit,
      }
      return scope;
  </script>
<style>
  .todo-wrapper {}
  form {
    background-color: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid var(--white);
    border-radius: 10px;
    padding: 10px;
    display: flex;
    flex-direction: column;
  }
</style>
</template>
